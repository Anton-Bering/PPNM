# Standard-mål: kompiler, mål tid, lav plot og generer Out.txt
all: main.exe timing plot
	@mono main.exe > Out.txt

GEN = ../../General/general_Vector_and_Matrix.cs

# Kompilér C#-kode
main.exe: Main.cs QR.cs $(GEN)
	mcs -out:$@ Main.cs QR.cs $(GEN)

# Del C: Hvor lang tid det tager at QR-faktorisere en NxN matrix
timing: main.exe
	@echo "# N    Time (seconds)" > QR_factorize_time.txt
	@for N in $(shell seq 100 20 500); do \
		mono main.exe -size:$$N >> QR_factorize_time.txt; \
	done

# Lav et plot af QR_factorize_time.txt og fit med f(x) = a*x**3
plot: QR_factorize_time.txt plot.gpi
	@gnuplot plot.gpi

# Åbn billedet i billedfremviser
open: QR_factorize_time.svg
	xdg-open QR_factorize_time.svg

# Ryd op
clean:
	rm -f main.exe Out.txt QR_factorize_time.txt QR_factorize_time.svg QR_factorize_time_fit.log
