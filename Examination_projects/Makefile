## Examination project Makefile

#  1) Compiler, flags, and runner
CS      := mcs
CFLAGS  := -target:exe -langversion:latest -optimize+
EXE     := main.exe
RUN     := mono $(EXE)

# 2) All output: Text file, generated datafiles, and plots
OUT     := Out.txt
# Data files generated by the C# program
DATA    := higgs_data.txt higgs_fit_curve.txt ann_approximation.txt
# Plot files we want to generate
PLOTS   := Higgs_fit.svg ANN_fit.svg

# 3) All C# Source files
SRC     := Main.cs QuasiNewton.cs Problems.cs \
           ../General/Vector.cs ../General/VectorHelpers.cs \
           ../General/Matrix.cs ../General/MatrixHelpers.cs \
           ../Homework/1_Linear_Equations/QR.cs

.PHONY: all run clean

# 'all’ builds both the output text file and the plots
all: $(OUT) $(PLOTS)

# Compile the executable file.
$(EXE): $(SRC)
	$(CS) $(CFLAGS) -out:$(EXE) $(SRC)

# Run the program to generate the output text file,
#    AND the data files which are used for the plots.
$(OUT) $(DATA): $(EXE)
	$(RUN) > $(OUT)

# Rule for creating the Higgs plot.
# It depends on the plot script and the generated data files.
Higgs_fit.svg: plot_higgs.gpi higgs_data.txt higgs_fit_curve.txt
	gnuplot $<

# Rule fir creating the ANN plot.
ANN_fit.svg: plot_ann.gpi ann_approximation.txt
	gnuplot $<

# ‘run’ runs the program and displays the output in the terminal
run: $(EXE)
	$(RUN)

# ‘clean’ deletes all generated files (executable program, generated text, data and plot files.
clean:
	rm -f $(EXE) $(OUT) $(DATA) $(PLOTS)